from google import genai
from google.genai import types
from pdf import pdf_builder
import json 

API_KEY = "AIzaSyDt8B8xI8L2UUYghC4ubdk1ENATCe33LuU"
client = genai.Client(api_key=API_KEY)
responses = []

#JSON READ:
with open('test.json', 'r') as file:
    data = json.load(file)
No_colonias = len(data["top_10_colonias"]) #total colonias no total fallas

cnt_fallas_chicas, cnt_fallas_medianas = 0
for i in range(No_colonias):
    data_col = data["top_10_colonias"][i]
    cnt_fallas_chicas = 




for i in range(No_colonias):
    responses.append(client.models.generate_content(
    model = "gemini-2.5-flash",

    config=types.GenerateContentConfig(
        thinking_config=types.ThinkingConfig(thinking_budget=0), # Disables thinking
        #settings:
        #temperature=0.5
        system_instruction=
        ("You are a Bank worker generating a report to the government regarding the state of a neighbourhoods public infrastructure "
         "The response has _ different structures, first make a paragraph with the information: Nombre colonia, Municipio, Cantidad de fallas chicas, Cantidad de fallas medianas, Cantidad de fallas grandes y prioridad promedio de falla"
         "Then in the next line costo de reparaci√≥n completa"
         "Then on a bulleted list the differnt sizes and their total cost"
         "Finally a small sentence or two describing the partial repairs you can do to reach an acceptable level") #gives instruccions over the prompt
    ),

    contents= f'''Make a small paragraph regarding the investment plan on a neighbourhood with potholes
    Here are some examples of the structure it should have
    
    La colonia Benito Juarez del municipio de Monterrey a recibido reporte de 3 fallas chicas, 5 fallas medianas, y 2 fallas grandes con un nivel promedio de falla de 2.4
    El costo total aproximado para arreglar todas las fallas es de 3200 pesos
    -Coste fallas chicas:   800
    -Coste fallas medianas: 900
    -Coste fallas grandes:  1500
    Se puede llegar a un promedio de falla menor a 2 si se resuelven 1 falla grande, 2 fallas medianas y 3 fallas chicas
    
    END OF EXAMPLE:
    Data: NOMBRE COLONIA {data["top_10_colonias"][i]["nombre_colonia"]}, Municipio Monterrey, fallas chicas '''
    ))

pdf_builder(No_colonias, responses)

#(responses[i]).text , asi accede a la respuesta por colonia.